<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title>Module: BoardViewer</title>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <link rel="stylesheet" href=".././rdoc-style.css" type="text/css" media="screen" />
  <script type="text/javascript">
  // <![CDATA[

  function popupCode( url ) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }

  function toggleCode( id ) {
    if ( document.getElementById )
      elem = document.getElementById( id );
    else if ( document.all )
      elem = eval( "document.all." + id );
    else
      return false;

    elemStyle = elem.style;
    
    if ( elemStyle.display != "block" ) {
      elemStyle.display = "block"
    } else {
      elemStyle.display = "none"
    }

    return true;
  }
  
  // Make codeblocks hidden by default
  document.writeln( "<style type=\"text/css\">div.method-source-code { display: none }</style>" )
  
  // ]]>
  </script>

</head>
<body>



    <div id="classHeader">
        <table class="header-table">
        <tr class="top-aligned-row">
          <td><strong>Module</strong></td>
          <td class="class-name-in-header">BoardViewer</td>
        </tr>
        <tr class="top-aligned-row">
            <td><strong>In:</strong></td>
            <td>
                <a href="../files/lib/ui/board_viewer_rb.html">
                lib/ui/board_viewer.rb
                </a>
        <br />
            </td>
        </tr>

        </table>
    </div>
  <!-- banner header -->

  <div id="bodyContent">



  <div id="contextContent">

    <div id="description">
      <p>
Base module for any GUI that wants to draw the board this includes math to
calculate the cartesian coordinates for hexes and nodes
</p>

    </div>


   </div>

    <div id="method-list">
      <h3 class="section-bar">Methods</h3>

      <div class="name-list">
      <a href="#M000609">calculate_all_vertices</a>&nbsp;&nbsp;
      <a href="#M000612">calculate_height_from_side</a>&nbsp;&nbsp;
      <a href="#M000608">calculate_hex_centers</a>&nbsp;&nbsp;
      <a href="#M000607">calculate_hex_verticies</a>&nbsp;&nbsp;
      <a href="#M000613">calculate_proximities</a>&nbsp;&nbsp;
      <a href="#M000610">calculate_side_from_full_width</a>&nbsp;&nbsp;
      <a href="#M000611">calculate_width_from_side</a>&nbsp;&nbsp;
      <a href="#M000606">calculated_coordinate_data?</a>&nbsp;&nbsp;
      <a href="#M000614">getOppositeCoords</a>&nbsp;&nbsp;
      <a href="#M000615">getTouchingPiece</a>&nbsp;&nbsp;
      <a href="#M000605">get_real_hexXY_coords</a>&nbsp;&nbsp;
      <a href="#M000604">get_real_hex_coords</a>&nbsp;&nbsp;
      <a href="#M000603">get_real_node_coords</a>&nbsp;&nbsp;
      <a href="#M000600">initialize_viewer</a>&nbsp;&nbsp;
      <a href="#M000616">isTouchingEdge?</a>&nbsp;&nbsp;
      <a href="#M000617">isTouchingNode?</a>&nbsp;&nbsp;
      <a href="#M000618">is_in_proximity</a>&nbsp;&nbsp;
      <a href="#M000601">set_board</a>&nbsp;&nbsp;
      <a href="#M000602">set_board_dimensions</a>&nbsp;&nbsp;
      </div>
    </div>

  </div>


    <!-- if includes -->
    <div id="includes">
      <h3 class="section-bar">Included Modules</h3>

      <div id="includes-list">
        <span class="include-name">Math</span>
      </div>
    </div>

    <div id="section">


    <div id="constants-list">
      <h3 class="section-bar">Constants</h3>

      <div class="name-list">
        <table summary="Constants">
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">Angle60</td>
          <td>=</td>
          <td class="context-item-value">PI / 3</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
Some simple math contants

</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">SinAngle60</td>
          <td>=</td>
          <td class="context-item-value">Math::sin(Angle60)</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">CosAngle60</td>
          <td>=</td>
          <td class="context-item-value">Math::cos(Angle60)</td>
        </tr>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">HeightRatio</td>
          <td>=</td>
          <td class="context-item-value">0.5 + (CosAngle60 / SinAngle60)</td>
          <td width="3em">&nbsp;</td>
          <td class="context-item-desc">
The ratio of height to width of a hexagon height * HeightRatio = width
HeightRation = 1/2 + (cos60 / sin 60)

</td>
        </tr>
        </table>
      </div>
    </div>



    <div id="attribute-list">
      <h3 class="section-bar">Attributes</h3>

      <div class="name-list">
        <table>
        <tr class="top-aligned-row context-row">
          <td class="context-item-name">hex_centers</td>
          <td class="context-item-value">&nbsp;[R]&nbsp;</td>
          <td class="context-item-desc"></td>
        </tr>
        </table>
      </div>
    </div>
      


    <!-- if method_list -->
    <div id="methods">
      <h3 class="section-bar">Public Instance methods</h3>

      <div id="method-M000609" class="method-detail">
        <a name="M000609"></a>

        <div class="method-heading">
          <a href="#M000609" class="method-signature">
          <span class="method-name">calculate_all_vertices</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Calculate and cache all real x,y coordinates for all hex nodes and edges
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000609-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000609-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 206</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate_all_vertices</span>
    <span class="ruby-ivar">@allEdges</span> = {}
    <span class="ruby-ivar">@gui_board</span>.<span class="ruby-identifier">tiles</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span> 
      <span class="ruby-identifier">verticies</span> = <span class="ruby-identifier">calculate_hex_verticies</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">t</span>.<span class="ruby-identifier">coords</span>)
      
      <span class="ruby-comment cmt">#Cache node coordinates</span>
      <span class="ruby-identifier">verticies</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">xy</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
        <span class="ruby-ivar">@allVertices</span>[<span class="ruby-identifier">t</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-identifier">i</span>]] = <span class="ruby-identifier">xy</span>
      <span class="ruby-keyword kw">end</span>
      
      <span class="ruby-comment cmt">#cache edge values</span>
      <span class="ruby-identifier">t</span>.<span class="ruby-identifier">nodes</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">node</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">j</span> = (<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>)<span class="ruby-operator">%</span><span class="ruby-value">6</span> 
        <span class="ruby-identifier">edge</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">edges</span>[<span class="ruby-identifier">j</span>]
        <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@allEdges</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">edge</span>)
          <span class="ruby-identifier">x1</span>,<span class="ruby-identifier">y1</span> = <span class="ruby-identifier">verticies</span>[<span class="ruby-identifier">i</span>]
          <span class="ruby-identifier">x2</span>,<span class="ruby-identifier">y2</span> = <span class="ruby-identifier">verticies</span>[<span class="ruby-identifier">j</span>]
          <span class="ruby-identifier">slope</span> = (<span class="ruby-identifier">y2</span><span class="ruby-operator">-</span><span class="ruby-identifier">y1</span>) <span class="ruby-operator">/</span> (<span class="ruby-identifier">x2</span><span class="ruby-operator">-</span><span class="ruby-identifier">x1</span>)
          <span class="ruby-ivar">@allEdges</span>[<span class="ruby-identifier">edge</span>] = [<span class="ruby-identifier">slope</span>, <span class="ruby-identifier">verticies</span>[<span class="ruby-identifier">i</span>], <span class="ruby-identifier">verticies</span>[<span class="ruby-identifier">j</span>]]
        <span class="ruby-keyword kw">end</span>
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-ivar">@allVerticesProx</span> = <span class="ruby-identifier">calculate_proximities</span>(<span class="ruby-identifier">proximity</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000612" class="method-detail">
        <a name="M000612"></a>

        <div class="method-heading">
          <a href="#M000612" class="method-signature">
          <span class="method-name">calculate_height_from_side</span><span class="method-args">(side)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Given the length of the side of a hex, this method will return the full
with of the hex.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000612-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000612-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 245</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate_height_from_side</span>(<span class="ruby-identifier">side</span>)
    <span class="ruby-constant">SinAngle60</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">side</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000608" class="method-detail">
        <a name="M000608"></a>

        <div class="method-heading">
          <a href="#M000608" class="method-signature">
          <span class="method-name">calculate_hex_centers</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
A cached mapping of hex -&gt; [x,y] where x and y are the center
coordinates of that hex
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000608-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000608-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 194</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate_hex_centers</span>
    <span class="ruby-ivar">@hex_centers</span> = {}
    <span class="ruby-identifier">half_width</span> = <span class="ruby-ivar">@hex_width</span> <span class="ruby-operator">/</span> <span class="ruby-value">2</span>
    <span class="ruby-identifier">half_height</span> = <span class="ruby-ivar">@hex_height</span> <span class="ruby-operator">/</span> <span class="ruby-value">2</span>
    <span class="ruby-ivar">@gui_board</span>.<span class="ruby-identifier">tiles</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span> = <span class="ruby-identifier">get_real_hex_coords</span>(<span class="ruby-identifier">t</span>)
      <span class="ruby-ivar">@hex_centers</span>[<span class="ruby-identifier">t</span>] = [<span class="ruby-identifier">x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">half_width</span>, <span class="ruby-identifier">y</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">half_height</span>]
    }
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000607" class="method-detail">
        <a name="M000607"></a>

        <div class="method-heading">
          <a href="#M000607" class="method-signature">
          <span class="method-name">calculate_hex_verticies</span><span class="method-args">(x, y)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Calculate all 6 vertex pairs for a particular hex coordinates
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000607-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000607-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 172</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate_hex_verticies</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>)
    <span class="ruby-identifier">x1</span> = <span class="ruby-constant">CosAngle60</span><span class="ruby-operator">*</span><span class="ruby-ivar">@hex_side</span>
    <span class="ruby-identifier">x2</span> = <span class="ruby-identifier">x1</span><span class="ruby-operator">+</span><span class="ruby-ivar">@hex_side</span>
    <span class="ruby-identifier">x3</span> = <span class="ruby-identifier">x1</span><span class="ruby-operator">+</span><span class="ruby-identifier">x2</span>
    <span class="ruby-identifier">y1</span> = <span class="ruby-constant">SinAngle60</span><span class="ruby-operator">*</span><span class="ruby-ivar">@hex_side</span>
    <span class="ruby-identifier">y2</span> = <span class="ruby-operator">-</span><span class="ruby-identifier">y1</span>

    <span class="ruby-comment cmt">#get the real hex offsets</span>
    <span class="ruby-identifier">realX</span> = (<span class="ruby-identifier">x</span><span class="ruby-operator">*</span><span class="ruby-identifier">x2</span>) <span class="ruby-operator">+</span> <span class="ruby-ivar">@xShift</span>
    <span class="ruby-identifier">realY</span> = (<span class="ruby-identifier">y</span><span class="ruby-operator">*</span><span class="ruby-value">2</span><span class="ruby-operator">*</span><span class="ruby-identifier">y1</span>)<span class="ruby-operator">+</span>((<span class="ruby-identifier">x</span><span class="ruby-operator">%</span><span class="ruby-value">2</span>)<span class="ruby-operator">*</span><span class="ruby-identifier">y1</span>) <span class="ruby-operator">+</span> <span class="ruby-identifier">y1</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@yShift</span>

    <span class="ruby-identifier">v1</span> = [<span class="ruby-identifier">x2</span>, <span class="ruby-identifier">y2</span>]
    <span class="ruby-identifier">v2</span> = [<span class="ruby-identifier">x3</span>,  <span class="ruby-value">0</span>]
    <span class="ruby-identifier">v3</span> = [<span class="ruby-identifier">x2</span>, <span class="ruby-identifier">y1</span>]
    <span class="ruby-identifier">v4</span> = [<span class="ruby-identifier">x1</span>, <span class="ruby-identifier">y1</span>]
    <span class="ruby-identifier">v5</span> = [<span class="ruby-value">0</span>,   <span class="ruby-value">0</span>]
    <span class="ruby-identifier">v6</span> = [<span class="ruby-identifier">x1</span>, <span class="ruby-identifier">y2</span>]
    [<span class="ruby-identifier">v1</span>,<span class="ruby-identifier">v2</span>,<span class="ruby-identifier">v3</span>,<span class="ruby-identifier">v4</span>,<span class="ruby-identifier">v5</span>,<span class="ruby-identifier">v6</span>].<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span>,<span class="ruby-identifier">b</span><span class="ruby-operator">|</span> [<span class="ruby-identifier">a</span><span class="ruby-operator">+</span><span class="ruby-identifier">realX</span>,<span class="ruby-identifier">b</span><span class="ruby-operator">+</span><span class="ruby-identifier">realY</span>]}
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000613" class="method-detail">
        <a name="M000613"></a>

        <div class="method-heading">
          <a href="#M000613" class="method-signature">
          <span class="method-name">calculate_proximities</span><span class="method-args">(prox)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
ensure that the nodeVertices are calculated
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000613-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000613-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 250</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate_proximities</span>(<span class="ruby-identifier">prox</span>)
    <span class="ruby-ivar">@allVertices</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span>, <span class="ruby-identifier">coords</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span> = <span class="ruby-identifier">coords</span>
      [<span class="ruby-identifier">n</span>, <span class="ruby-identifier">x</span><span class="ruby-operator">-</span><span class="ruby-identifier">prox</span>, <span class="ruby-identifier">y</span><span class="ruby-operator">-</span><span class="ruby-identifier">prox</span>, <span class="ruby-identifier">x</span><span class="ruby-operator">+</span><span class="ruby-identifier">prox</span>, <span class="ruby-identifier">y</span><span class="ruby-operator">+</span><span class="ruby-identifier">prox</span>]
    <span class="ruby-keyword kw">end</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000610" class="method-detail">
        <a name="M000610"></a>

        <div class="method-heading">
          <a href="#M000610" class="method-signature">
          <span class="method-name">calculate_side_from_full_width</span><span class="method-args">(width)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Given the width of a hex, this will calculate the Length of a single side.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000610-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000610-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 233</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate_side_from_full_width</span>(<span class="ruby-identifier">width</span>)
    <span class="ruby-keyword kw">return</span> (<span class="ruby-identifier">width</span> <span class="ruby-operator">/</span> (<span class="ruby-value">1</span> <span class="ruby-operator">+</span> (<span class="ruby-constant">CosAngle60</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>)))
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000611" class="method-detail">
        <a name="M000611"></a>

        <div class="method-heading">
          <a href="#M000611" class="method-signature">
          <span class="method-name">calculate_width_from_side</span><span class="method-args">(side)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Given the length of the side of a hex, this method will return the full
with of the hex.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000611-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000611-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 239</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculate_width_from_side</span>(<span class="ruby-identifier">side</span>)
    <span class="ruby-identifier">side</span> <span class="ruby-operator">+</span> (<span class="ruby-constant">CosAngle60</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">side</span> <span class="ruby-operator">*</span> <span class="ruby-value">2</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000606" class="method-detail">
        <a name="M000606"></a>

        <div class="method-heading">
          <a href="#M000606" class="method-signature">
          <span class="method-name">calculated_coordinate_data?</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000606-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000606-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 166</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">calculated_coordinate_data?</span>
    <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@gui_board</span>
    <span class="ruby-ivar">@allVertices</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@gui_board</span>.<span class="ruby-identifier">all_nodes</span>.<span class="ruby-identifier">size</span> <span class="ruby-keyword kw">and</span> (<span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@allVertices</span>.<span class="ruby-identifier">empty?</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000614" class="method-detail">
        <a name="M000614"></a>

        <div class="method-heading">
          <a href="#M000614" class="method-signature">
          <span class="method-name">getOppositeCoords</span><span class="method-args">(hex, edge)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Given a hex and an edge, this method will return the xy coords of the other
side of the edge. For instance, if you give this a hex on the side of the
board and an edge on the side of the board, this will return the xy coords
of the imaginary hex.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000614-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000614-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 262</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">getOppositeCoords</span>(<span class="ruby-identifier">hex</span>, <span class="ruby-identifier">edge</span>)
    <span class="ruby-identifier">edgeNum</span> = <span class="ruby-identifier">hex</span>.<span class="ruby-identifier">edges</span>.<span class="ruby-identifier">index</span>(<span class="ruby-identifier">edge</span>)
    <span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span> = <span class="ruby-identifier">hex</span>.<span class="ruby-identifier">coords</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">edgeNum</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
      <span class="ruby-identifier">y</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">edgeNum</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">y</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">edgeNum</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>
      <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">y</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">y</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>)      
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">edgeNum</span> <span class="ruby-operator">==</span> <span class="ruby-value">3</span>
      <span class="ruby-identifier">y</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">edgeNum</span> <span class="ruby-operator">==</span> <span class="ruby-value">4</span>
      <span class="ruby-identifier">x</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">y</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">y</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>)      
    <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">edgeNum</span> <span class="ruby-operator">==</span> <span class="ruby-value">5</span>
      <span class="ruby-identifier">x</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">y</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword kw">end</span>
    [<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000615" class="method-detail">
        <a name="M000615"></a>

        <div class="method-heading">
          <a href="#M000615" class="method-signature">
          <span class="method-name">getTouchingPiece</span><span class="method-args">(x, y, proximity, turn)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
gets the piece the user has the cursor on,
</p>
<pre>
 returns an Edge for a road, [Settlement, node], or [City, node], or nil
</pre>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000615-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000615-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 289</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">getTouchingPiece</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">proximity</span>, <span class="ruby-identifier">turn</span>)
    <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">turn</span>
    <span class="ruby-identifier">nodeTouch</span> = <span class="ruby-identifier">isTouchingNode?</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">proximity</span>)

    <span class="ruby-identifier">is_setup_turn</span> = <span class="ruby-identifier">turn</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">SetupTurn</span>

    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">nodeTouch</span> 
      <span class="ruby-identifier">n</span>, <span class="ruby-identifier">nx</span>, <span class="ruby-identifier">ny</span> = <span class="ruby-identifier">nodeTouch</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">can_afford?</span>([<span class="ruby-constant">City</span>]) <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">piecesLeft</span>[<span class="ruby-constant">City</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">spots</span> = <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">board</span>.<span class="ruby-identifier">get_valid_city_spots</span>(<span class="ruby-ivar">@player</span>.<span class="ruby-identifier">color</span>)
        <span class="ruby-keyword kw">return</span> [<span class="ruby-constant">City</span>, <span class="ruby-identifier">n</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">spots</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">n</span>)
      <span class="ruby-keyword kw">end</span>

      <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">is_setup_turn</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">turn</span>.<span class="ruby-identifier">placed_settlement</span>) <span class="ruby-keyword kw">or</span> 
              (<span class="ruby-ivar">@player</span>.<span class="ruby-identifier">can_afford?</span>([<span class="ruby-constant">Settlement</span>]) <span class="ruby-keyword kw">and</span> 
               <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">piecesLeft</span>[<span class="ruby-constant">Settlement</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-identifier">spots</span> = <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">board</span>.<span class="ruby-identifier">get_valid_settlement_spots</span>(<span class="ruby-operator">!</span><span class="ruby-identifier">is_setup_turn</span>, <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">color</span>)
        <span class="ruby-keyword kw">return</span> [<span class="ruby-constant">Settlement</span>, <span class="ruby-identifier">n</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">spots</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">n</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
    
    <span class="ruby-identifier">edgeTouch</span> = <span class="ruby-identifier">isTouchingEdge?</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">proximity</span>)
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">edgeTouch</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">is_setup_turn</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">turn</span>.<span class="ruby-identifier">placed_settlement</span>
        <span class="ruby-identifier">edge</span>, <span class="ruby-identifier">c1</span>, <span class="ruby-identifier">c2</span> = <span class="ruby-identifier">edgeTouch</span>
        <span class="ruby-identifier">placed_settlement</span> = <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">board</span>.<span class="ruby-identifier">getNode</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">turn</span>.<span class="ruby-identifier">placed_settlement</span>)
        <span class="ruby-identifier">spots</span> = <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">board</span>.<span class="ruby-identifier">get_valid_road_spots</span>(<span class="ruby-ivar">@player</span>.<span class="ruby-identifier">color</span>, <span class="ruby-identifier">placed_settlement</span>)
        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">edge</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">spots</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">edge</span>)
      <span class="ruby-keyword kw">elsif</span> (<span class="ruby-ivar">@player</span>.<span class="ruby-identifier">can_afford?</span>([<span class="ruby-constant">Road</span>]) <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">purchased_pieces</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">piecesLeft</span>[<span class="ruby-constant">Road</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
        <span class="ruby-identifier">edge</span>, <span class="ruby-identifier">c1</span>, <span class="ruby-identifier">c2</span> = <span class="ruby-identifier">edgeTouch</span>
        <span class="ruby-identifier">spots</span> = <span class="ruby-ivar">@player</span>.<span class="ruby-identifier">board</span>.<span class="ruby-identifier">get_valid_road_spots</span>(<span class="ruby-ivar">@player</span>.<span class="ruby-identifier">color</span>)
        <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">edge</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">spots</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">edge</span>)
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>

    <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000605" class="method-detail">
        <a name="M000605"></a>

        <div class="method-heading">
          <a href="#M000605" class="method-signature">
          <span class="method-name">get_real_hexXY_coords</span><span class="method-args">(hex_x, hex_y)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the xy coordinates (in pixels) of the given hex coordinates This is
used to draw a specific hex
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000605-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000605-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 161</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_real_hexXY_coords</span>(<span class="ruby-identifier">hex_x</span>, <span class="ruby-identifier">hex_y</span>)
    <span class="ruby-identifier">vs</span> = <span class="ruby-identifier">calculate_hex_verticies</span>(<span class="ruby-identifier">hex_x</span>, <span class="ruby-identifier">hex_y</span>)
    [<span class="ruby-identifier">vs</span>[<span class="ruby-value">4</span>][<span class="ruby-value">0</span>], <span class="ruby-identifier">vs</span>[<span class="ruby-value">5</span>][<span class="ruby-value">1</span>]]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000604" class="method-detail">
        <a name="M000604"></a>

        <div class="method-heading">
          <a href="#M000604" class="method-signature">
          <span class="method-name">get_real_hex_coords</span><span class="method-args">(hex)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the xy coordinates (in pixels) of the given hex This is used to draw a
specific hex
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000604-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000604-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 150</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_real_hex_coords</span>(<span class="ruby-identifier">hex</span>)
    <span class="ruby-identifier">n1</span> = <span class="ruby-ivar">@allVertices</span>[<span class="ruby-identifier">hex</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-value">4</span>]]
    <span class="ruby-identifier">n2</span> = <span class="ruby-ivar">@allVertices</span>[<span class="ruby-identifier">hex</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-value">5</span>]]
    <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Bad Node at #{hex.nodes[4].coords}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">n1</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">x</span> = <span class="ruby-identifier">n1</span>[<span class="ruby-value">0</span>]
    <span class="ruby-identifier">y</span> = <span class="ruby-identifier">n2</span>[<span class="ruby-value">1</span>]
    [<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>]
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000603" class="method-detail">
        <a name="M000603"></a>

        <div class="method-heading">
          <a href="#M000603" class="method-signature">
          <span class="method-name">get_real_node_coords</span><span class="method-args">(node)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Get the coordinates (in pixels) of a given node.
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000603-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000603-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 144</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">get_real_node_coords</span>(<span class="ruby-identifier">node</span>)
    <span class="ruby-ivar">@allVertices</span>[<span class="ruby-identifier">node</span>] 
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000600" class="method-detail">
        <a name="M000600"></a>

        <div class="method-heading">
          <a href="#M000600" class="method-signature">
          <span class="method-name">initialize_viewer</span><span class="method-args">()</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000600-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000600-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 35</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize_viewer</span>
    <span class="ruby-comment cmt">#A mapping of nodes to real x, y coordinates.</span>
    <span class="ruby-comment cmt">#This is cached to save time.</span>
    <span class="ruby-comment cmt">#&lt;node, [x,y]&gt;</span>
    <span class="ruby-ivar">@allVertices</span> = {} 
    
    <span class="ruby-comment cmt">#This is a mapping of nodes to their proximity boundaries &lt;n, (x1,y1,x2,y2)&gt;</span>
    <span class="ruby-ivar">@allVerticesProx</span> = {}
    
    <span class="ruby-comment cmt">#[edge, slope, point1, point2] (points are [x,y] pairs</span>
    <span class="ruby-ivar">@allEdges</span> = {}
   
    <span class="ruby-comment cmt"># A cached mapping of hex -&gt; [x,y] where x and y are the center coordinates</span>
    <span class="ruby-comment cmt"># of that hex    </span>
    <span class="ruby-ivar">@hex_centers</span> = <span class="ruby-keyword kw">nil</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000616" class="method-detail">
        <a name="M000616"></a>

        <div class="method-heading">
          <a href="#M000616" class="method-signature">
          <span class="method-name">isTouchingEdge?</span><span class="method-args">(x, y, threshold)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000616-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000616-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 328</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">isTouchingEdge?</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">threshold</span>)
<span class="ruby-comment cmt">#    return false unless calculated_coordinate_data?  </span>
    <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">edge</span>, <span class="ruby-identifier">angles</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@allEdges</span>
      <span class="ruby-identifier">slope</span>, <span class="ruby-identifier">coord1</span>, <span class="ruby-identifier">coord2</span> = <span class="ruby-identifier">angles</span>
      <span class="ruby-identifier">coord1</span>, <span class="ruby-identifier">coord2</span> = <span class="ruby-identifier">coord2</span>, <span class="ruby-identifier">coord1</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">coord1</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">coord2</span>[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">x1</span>,<span class="ruby-identifier">y1</span> = <span class="ruby-identifier">coord1</span>
      <span class="ruby-identifier">x2</span>,<span class="ruby-identifier">y2</span> = <span class="ruby-identifier">coord2</span>
      <span class="ruby-identifier">lineY</span> = ((<span class="ruby-identifier">x</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">x1</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">slope</span>)<span class="ruby-operator">+</span><span class="ruby-identifier">y1</span>
      <span class="ruby-identifier">deltaY</span> = (<span class="ruby-identifier">y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lineY</span>).<span class="ruby-identifier">abs</span>
      <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">edge</span>, <span class="ruby-identifier">coord1</span>, <span class="ruby-identifier">coord2</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">deltaY</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">threshold</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">between?</span>(<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">x2</span>)
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">false</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000617" class="method-detail">
        <a name="M000617"></a>

        <div class="method-heading">
          <a href="#M000617" class="method-signature">
          <span class="method-name">isTouchingNode?</span><span class="method-args">(x, y, proximity)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
are the given coordinates touching a node? if so, return [node, node-x,
node-y] where x and y are the real x and y of the node
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000617-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000617-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 344</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">isTouchingNode?</span>(<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>, <span class="ruby-identifier">proximity</span>)
    <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">n</span>,<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">y1</span>,<span class="ruby-identifier">x2</span>,<span class="ruby-identifier">y2</span> <span class="ruby-keyword kw">in</span> <span class="ruby-ivar">@allVerticesProx</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">between?</span>(<span class="ruby-identifier">x1</span>,<span class="ruby-identifier">x2</span>) <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">y</span>.<span class="ruby-identifier">between?</span>(<span class="ruby-identifier">y1</span>,<span class="ruby-identifier">y2</span>)
        <span class="ruby-identifier">nx</span>, <span class="ruby-identifier">ny</span> = <span class="ruby-identifier">x1</span><span class="ruby-operator">+</span><span class="ruby-identifier">proximity</span>, <span class="ruby-identifier">y1</span><span class="ruby-operator">+</span><span class="ruby-identifier">proximity</span>
        <span class="ruby-keyword kw">return</span> [<span class="ruby-identifier">n</span>, <span class="ruby-identifier">nx</span>, <span class="ruby-identifier">ny</span>]
      <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">end</span>
    <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000618" class="method-detail">
        <a name="M000618"></a>

        <div class="method-heading">
          <a href="#M000618" class="method-signature">
          <span class="method-name">is_in_proximity</span><span class="method-args">(target_x, target_y, proximity, test_x, test_y)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Are the given 2D test coordinates within proximity of the target coords?
</p>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000618-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000618-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 355</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">is_in_proximity</span>(<span class="ruby-identifier">target_x</span>, <span class="ruby-identifier">target_y</span>, <span class="ruby-identifier">proximity</span>, <span class="ruby-identifier">test_x</span>, <span class="ruby-identifier">test_y</span>)
    <span class="ruby-keyword kw">return</span> ((<span class="ruby-identifier">target_x</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">test_x</span>).<span class="ruby-identifier">abs</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">proximity</span> <span class="ruby-keyword kw">and</span>
           (<span class="ruby-identifier">target_y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">test_y</span>).<span class="ruby-identifier">abs</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">proximity</span>)
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000601" class="method-detail">
        <a name="M000601"></a>

        <div class="method-heading">
          <a href="#M000601" class="method-signature">
          <span class="method-name">set_board</span><span class="method-args">(board)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Set the board that is to be used for GUI calculations
</p>
<dl>
<dt>board</dt><dd>The <a href="Board.html">Board</a> object

</dd>
</dl>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000601-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000601-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 54</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_board</span>(<span class="ruby-identifier">board</span>)
    <span class="ruby-ivar">@gui_board</span> = <span class="ruby-identifier">board</span>
 
    <span class="ruby-comment cmt">#calculate the board's tile dimensions.</span>
    <span class="ruby-identifier">board_x_min</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">board_x_max</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">board_y_min</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">board_y_max</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">board</span>.<span class="ruby-identifier">tiles</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">t</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span> = <span class="ruby-identifier">t</span>.<span class="ruby-identifier">coords</span>
      <span class="ruby-identifier">y</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">x</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span>) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
      
      <span class="ruby-comment cmt">#Account for the port tiles</span>
      <span class="ruby-comment cmt">#We want to increase the board's dimensions to hold the port tiles.</span>
      <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-value">4</span>].<span class="ruby-identifier">port</span>
        <span class="ruby-identifier">x</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> 
        <span class="ruby-identifier">y</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> 
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-value">5</span>].<span class="ruby-identifier">port</span>
        <span class="ruby-identifier">x</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> 
        <span class="ruby-identifier">y</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">port</span>
        <span class="ruby-identifier">y</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span> 
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-value">3</span>].<span class="ruby-identifier">port</span>
        <span class="ruby-identifier">y</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> 
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">port</span>
        <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> 
        <span class="ruby-identifier">y</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">t</span>.<span class="ruby-identifier">nodes</span>[<span class="ruby-value">2</span>].<span class="ruby-identifier">port</span>
        <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> 
        <span class="ruby-identifier">y</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword kw">end</span>   
      
      <span class="ruby-identifier">board_x_min</span> = <span class="ruby-identifier">x</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">board_x_min</span>
      <span class="ruby-identifier">board_x_max</span> = <span class="ruby-identifier">x</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">board_x_max</span>
      <span class="ruby-identifier">board_y_min</span> = <span class="ruby-identifier">y</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">y</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">board_y_min</span>
      <span class="ruby-identifier">board_y_max</span> = <span class="ruby-identifier">y</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">y</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">board_y_max</span>
    }
    <span class="ruby-comment cmt">#The board height (in tiles)</span>
    <span class="ruby-ivar">@board_tile_height</span> = <span class="ruby-identifier">board_y_max</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">board_y_min</span>

    <span class="ruby-comment cmt">#The board width (in tiles)</span>
    <span class="ruby-ivar">@board_tile_width</span> = <span class="ruby-identifier">board_x_max</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">board_x_min</span>
    
    <span class="ruby-comment cmt">#The x (game coordinate) of the leftmost board tile.</span>
    <span class="ruby-ivar">@left_most_tile_coord</span> = <span class="ruby-identifier">board_x_min</span>

    <span class="ruby-comment cmt">#The y (game coordinate) of the topmost board tile.</span>
    <span class="ruby-ivar">@top_most_tile_coord</span> = <span class="ruby-identifier">board_y_min</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>

      <div id="method-M000602" class="method-detail">
        <a name="M000602"></a>

        <div class="method-heading">
          <a href="#M000602" class="method-signature">
          <span class="method-name">set_board_dimensions</span><span class="method-args">(left, top, width, height)</span>
          </a>
        </div>
      
        <div class="method-description">
          <p>
Sets the 2D UI dimensions that the board is shown in All other methods rely
on the board position to make assumptions about the pixel placement. So,
this method must be set before any UI methods are called.
</p>
<dl>
<dt>left</dt><dd>the left most position (in pixels) of the board.

</dd>
<dt>top</dt><dd>the top most position (in pixels) of the board

</dd>
<dt>width</dt><dd>the pixel width of the board.

</dd>
<dt>height</dt><dd>the pixel height of the board.

</dd>
</dl>
          <p><a class="source-toggle" href="#"
            onclick="toggleCode('M000602-source');return false;">[Source]</a></p>
          <div class="method-source-code" id="M000602-source">
<pre>
<span class="ruby-comment cmt"># File lib/ui/board_viewer.rb, line 114</span>
  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">set_board_dimensions</span>(<span class="ruby-identifier">left</span>, <span class="ruby-identifier">top</span>, <span class="ruby-identifier">width</span>, <span class="ruby-identifier">height</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-value str">'Board not set. set_board(board) needs to be called before this method.'</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@gui_board</span>
    <span class="ruby-ivar">@board_left</span> = <span class="ruby-identifier">left</span>
    <span class="ruby-ivar">@board_top</span> = <span class="ruby-identifier">top</span>
    <span class="ruby-ivar">@board_pixel_width</span> = <span class="ruby-identifier">width</span>
    <span class="ruby-ivar">@board_pixel_height</span> = <span class="ruby-identifier">height</span>
    
    <span class="ruby-comment cmt">#The width (in pixels) of a single hex</span>
    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">width</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">height</span>
      <span class="ruby-ivar">@hex_height</span> = <span class="ruby-identifier">height</span> <span class="ruby-operator">/</span> <span class="ruby-ivar">@board_tile_height</span>
      <span class="ruby-ivar">@hex_width</span> = <span class="ruby-ivar">@hex_height</span> <span class="ruby-operator">*</span> <span class="ruby-constant">HeightRatio</span>
    <span class="ruby-keyword kw">else</span>
      <span class="ruby-ivar">@hex_width</span> = <span class="ruby-identifier">width</span> <span class="ruby-operator">/</span> <span class="ruby-ivar">@board_tile_width</span>
    <span class="ruby-keyword kw">end</span>
    
    <span class="ruby-comment cmt">#The size of a single hex side</span>
    <span class="ruby-ivar">@hex_side</span> = <span class="ruby-identifier">calculate_side_from_full_width</span>(<span class="ruby-ivar">@hex_width</span>).<span class="ruby-identifier">floor</span>
    
    <span class="ruby-comment cmt">#Now that we've decided on the hex side, recalculate the width and height</span>
    <span class="ruby-ivar">@hex_width</span> = <span class="ruby-identifier">calculate_width_from_side</span>(<span class="ruby-ivar">@hex_side</span>)
    <span class="ruby-ivar">@hex_height</span> = <span class="ruby-identifier">calculate_height_from_side</span>(<span class="ruby-ivar">@hex_side</span>)
    
    <span class="ruby-ivar">@xShift</span> = (<span class="ruby-identifier">width</span> <span class="ruby-operator">/</span> <span class="ruby-value">2</span>) <span class="ruby-operator">-</span> (<span class="ruby-ivar">@hex_side</span> <span class="ruby-operator">/</span> <span class="ruby-value">2</span>)  <span class="ruby-comment cmt"># center it</span>

    <span class="ruby-ivar">@yShift</span> = (<span class="ruby-ivar">@hex_height</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@top_most_tile_coord</span>).<span class="ruby-identifier">abs</span>
    <span class="ruby-identifier">calculate_all_vertices</span>
    <span class="ruby-identifier">calculate_hex_centers</span>
  <span class="ruby-keyword kw">end</span>
</pre>
          </div>
        </div>
      </div>


    </div>


  </div>


<div id="validator-badges">
  <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
</div>

</body>
</html>